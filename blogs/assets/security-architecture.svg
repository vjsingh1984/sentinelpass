<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 700" width="900" height="700">
  <defs>
    <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f172a"/>
      <stop offset="100%" style="stop-color:#1e293b"/>
    </linearGradient>
    <linearGradient id="blueGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#1a56db"/>
      <stop offset="100%" style="stop-color:#0ea5e9"/>
    </linearGradient>
    <linearGradient id="greenGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#059669"/>
      <stop offset="100%" style="stop-color:#10b981"/>
    </linearGradient>
    <filter id="glow">
      <feGaussianBlur stdDeviation="3" result="blur"/>
      <feMerge>
        <feMergeNode in="blur"/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="900" height="700" fill="url(#bgGrad)" rx="12"/>

  <!-- Title -->
  <text x="450" y="45" text-anchor="middle" fill="#f1f5f9" font-family="system-ui, -apple-system, sans-serif" font-size="22" font-weight="700">SentinelPass Security Architecture</text>
  <text x="450" y="68" text-anchor="middle" fill="#94a3b8" font-family="system-ui, sans-serif" font-size="13">Zero-Knowledge Key Hierarchy &amp; Encryption Flow</text>

  <!-- Row 1: Master Password -->
  <rect x="300" y="90" width="300" height="50" rx="8" fill="none" stroke="#f59e0b" stroke-width="2"/>
  <text x="450" y="120" text-anchor="middle" fill="#fbbf24" font-family="monospace" font-size="15" font-weight="600">Master Password</text>
  <text x="450" y="135" text-anchor="middle" fill="#94a3b8" font-family="monospace" font-size="9">user-memorized secret</text>

  <!-- Arrow 1 -->
  <line x1="450" y1="140" x2="450" y2="165" stroke="#475569" stroke-width="2" marker-end="url(#arrowDown)"/>
  <polygon points="445,163 450,173 455,163" fill="#475569"/>

  <!-- Row 2: Argon2id KDF -->
  <rect x="250" y="175" width="400" height="60" rx="8" fill="url(#blueGrad)" opacity="0.9"/>
  <text x="450" y="200" text-anchor="middle" fill="#ffffff" font-family="monospace" font-size="15" font-weight="700">Argon2id KDF</text>
  <text x="450" y="220" text-anchor="middle" fill="#bfdbfe" font-family="monospace" font-size="11">m=256MB · t=3 iterations · p=4 lanes · 16-byte salt</text>

  <!-- Arrow 2 -->
  <polygon points="445,237 450,247 455,237" fill="#475569"/>

  <!-- Row 3: Master Key -->
  <rect x="320" y="250" width="260" height="45" rx="8" fill="none" stroke="#0ea5e9" stroke-width="2"/>
  <text x="450" y="278" text-anchor="middle" fill="#38bdf8" font-family="monospace" font-size="14" font-weight="600">32-byte Master Key</text>

  <!-- Arrow 3 (splits into 3) -->
  <line x1="450" y1="295" x2="450" y2="315" stroke="#475569" stroke-width="2"/>
  <line x1="450" y1="315" x2="150" y2="315" stroke="#475569" stroke-width="2"/>
  <line x1="450" y1="315" x2="750" y2="315" stroke="#475569" stroke-width="2"/>
  <line x1="150" y1="315" x2="150" y2="340" stroke="#475569" stroke-width="2"/>
  <line x1="450" y1="315" x2="450" y2="340" stroke="#475569" stroke-width="2"/>
  <line x1="750" y1="315" x2="750" y2="340" stroke="#475569" stroke-width="2"/>
  <polygon points="145,338 150,348 155,338" fill="#475569"/>
  <polygon points="445,338 450,348 455,338" fill="#475569"/>
  <polygon points="745,338 750,348 755,338" fill="#475569"/>

  <!-- Row 4: Three derived keys -->
  <rect x="55" y="350" width="190" height="50" rx="8" fill="none" stroke="#10b981" stroke-width="2"/>
  <text x="150" y="372" text-anchor="middle" fill="#34d399" font-family="monospace" font-size="13" font-weight="600">Vault Key</text>
  <text x="150" y="389" text-anchor="middle" fill="#6ee7b7" font-family="monospace" font-size="10">(wrapped)</text>

  <rect x="355" y="350" width="190" height="50" rx="8" fill="none" stroke="#10b981" stroke-width="2"/>
  <text x="450" y="372" text-anchor="middle" fill="#34d399" font-family="monospace" font-size="13" font-weight="600">HMAC Key</text>
  <text x="450" y="389" text-anchor="middle" fill="#6ee7b7" font-family="monospace" font-size="10">(derived)</text>

  <rect x="655" y="350" width="190" height="50" rx="8" fill="none" stroke="#10b981" stroke-width="2"/>
  <text x="750" y="372" text-anchor="middle" fill="#34d399" font-family="monospace" font-size="13" font-weight="600">Biometric Wrapper</text>
  <text x="750" y="389" text-anchor="middle" fill="#6ee7b7" font-family="monospace" font-size="10">(Touch ID / Hello)</text>

  <!-- Arrow 4 (from Vault Key down) -->
  <line x1="150" y1="400" x2="150" y2="425" stroke="#475569" stroke-width="2"/>
  <line x1="150" y1="425" x2="450" y2="425" stroke="#475569" stroke-width="2"/>
  <polygon points="445,420 455,425 445,430" fill="#475569"/>

  <!-- Row 5: DEK -->
  <rect x="320" y="435" width="260" height="45" rx="8" fill="none" stroke="#8b5cf6" stroke-width="2"/>
  <text x="450" y="458" text-anchor="middle" fill="#a78bfa" font-family="monospace" font-size="13" font-weight="600">Data Encryption Key</text>
  <text x="450" y="472" text-anchor="middle" fill="#c4b5fd" font-family="monospace" font-size="10">(DEK)</text>

  <!-- Arrow 5 -->
  <polygon points="445,482 450,492 455,482" fill="#475569"/>

  <!-- Row 6: Per-entry encryption -->
  <rect x="250" y="495" width="400" height="60" rx="8" fill="url(#greenGrad)" opacity="0.9"/>
  <text x="450" y="520" text-anchor="middle" fill="#ffffff" font-family="monospace" font-size="15" font-weight="700">AES-256-GCM</text>
  <text x="450" y="538" text-anchor="middle" fill="#d1fae5" font-family="monospace" font-size="11">Per-entry encryption with unique nonce</text>

  <!-- Side annotations -->
  <!-- Left side -->
  <rect x="30" y="500" width="180" height="30" rx="6" fill="#1e293b" stroke="#334155" stroke-width="1"/>
  <text x="120" y="520" text-anchor="middle" fill="#94a3b8" font-family="monospace" font-size="11">96-bit random nonce</text>
  <line x1="210" y1="515" x2="250" y2="520" stroke="#334155" stroke-width="1"/>

  <rect x="30" y="540" width="180" height="30" rx="6" fill="#1e293b" stroke="#334155" stroke-width="1"/>
  <text x="120" y="560" text-anchor="middle" fill="#94a3b8" font-family="monospace" font-size="11">128-bit auth tag</text>
  <line x1="210" y1="555" x2="250" y2="545" stroke="#334155" stroke-width="1"/>

  <!-- Right side -->
  <rect x="690" y="500" width="180" height="30" rx="6" fill="#1e293b" stroke="#334155" stroke-width="1"/>
  <text x="780" y="520" text-anchor="middle" fill="#94a3b8" font-family="monospace" font-size="11">zeroize() on drop</text>
  <line x1="690" y1="515" x2="650" y2="520" stroke="#334155" stroke-width="1"/>

  <rect x="690" y="540" width="180" height="30" rx="6" fill="#1e293b" stroke="#334155" stroke-width="1"/>
  <text x="780" y="560" text-anchor="middle" fill="#94a3b8" font-family="monospace" font-size="11">mlock() via memsec</text>
  <line x1="690" y1="555" x2="650" y2="545" stroke="#334155" stroke-width="1"/>

  <!-- Bottom: encrypted entries illustration -->
  <rect x="280" y="580" width="100" height="40" rx="6" fill="#1e293b" stroke="#475569" stroke-width="1"/>
  <text x="330" y="604" text-anchor="middle" fill="#64748b" font-family="monospace" font-size="10">Entry 1</text>

  <rect x="400" y="580" width="100" height="40" rx="6" fill="#1e293b" stroke="#475569" stroke-width="1"/>
  <text x="450" y="604" text-anchor="middle" fill="#64748b" font-family="monospace" font-size="10">Entry 2</text>

  <rect x="520" y="580" width="100" height="40" rx="6" fill="#1e293b" stroke="#475569" stroke-width="1"/>
  <text x="570" y="604" text-anchor="middle" fill="#64748b" font-family="monospace" font-size="10">Entry N</text>

  <line x1="330" y1="555" x2="330" y2="580" stroke="#475569" stroke-width="1" stroke-dasharray="4"/>
  <line x1="450" y1="555" x2="450" y2="580" stroke="#475569" stroke-width="1" stroke-dasharray="4"/>
  <line x1="570" y1="555" x2="570" y2="580" stroke="#475569" stroke-width="1" stroke-dasharray="4"/>

  <!-- Lock icons -->
  <text x="310" y="600" fill="#475569" font-size="14">&#x1f512;</text>
  <text x="430" y="600" fill="#475569" font-size="14">&#x1f512;</text>
  <text x="550" y="600" fill="#475569" font-size="14">&#x1f512;</text>

  <!-- Footer -->
  <text x="450" y="660" text-anchor="middle" fill="#475569" font-family="system-ui, sans-serif" font-size="11">SentinelPass — Zero-Knowledge Password Manager</text>
  <text x="450" y="680" text-anchor="middle" fill="#334155" font-family="system-ui, sans-serif" font-size="10">github.com/AltamashSentinelPass/sentinelpass · Apache 2.0</text>
</svg>